CMAKE_MINIMUM_REQUIRED(VERSION 3.2)


SET(FE_FRAMEWORK "FE_FRAMEWORK")


SET(_FRAMEWORK_
	${CMAKE_CURRENT_SOURCE_DIR}/../../FE/framework/framework.hpp
	)
SOURCE_GROUP("FE\\framework" FILES ${_FRAMEWORK_})

SET(_FRAMEWORK_REFLECTION_
	${CMAKE_CURRENT_SOURCE_DIR}/../../FE/framework/reflection/function_table.hpp
	)
SOURCE_GROUP("FE\\framework\\reflection" FILES ${_FRAMEWORK_REFLECTION_})

SET(_FRAMEWORK_PRIVATE_
	${CMAKE_CURRENT_SOURCE_DIR}/../../FE/framework/private/framework.cpp
	${CMAKE_CURRENT_SOURCE_DIR}/../../FE/framework/private/function_table.cpp
	${CMAKE_CURRENT_SOURCE_DIR}/../../FE/framework/private/internal_functions.h
	)
SOURCE_GROUP("FE\\framework\\private" FILES ${_FRAMEWORK_PRIVATE_})


ADD_LIBRARY(${FE_FRAMEWORK} STATIC
	${_FRAMEWORK_}
	${_FRAMEWORK_REFLECTION_}
	${_FRAMEWORK_PRIVATE_}
)


if(CMAKE_SYSTEM_NAME STREQUAL "Linux")
	MESSAGE("Configurating The Build Environment for Linux X86-64 Distributions")

	if(GNU_CPP)
		TARGET_COMPILE_OPTIONS(${FE_FRAMEWORK} PRIVATE
			$<$<CONFIG:DEBUG>:			${DEBUG_COMPILE_OPTIONS} 			-mavx>
			$<$<CONFIG:RELWITHDEBINFO>: ${RELWITHDEBINFO_COMPILE_OPTIONS} 	-mavx>
			$<$<CONFIG:RELEASE>:		${RELEASE_COMPILE_OPTIONS} 			-mavx>
			$<$<CONFIG:MINSIZEREL>:		${MINSIZEREL_COMPILE_OPTIONS} 		-mavx>
		)
	elseif(CLANG_CPP)
		TARGET_COMPILE_OPTIONS(${FE_FRAMEWORK} PRIVATE
			$<$<CONFIG:DEBUG>:			${DEBUG_COMPILE_OPTIONS} 			-mavx>
			$<$<CONFIG:RELWITHDEBINFO>: ${RELWITHDEBINFO_COMPILE_OPTIONS} 	-mavx>
			$<$<CONFIG:RELEASE>:		${RELEASE_COMPILE_OPTIONS} 			-mavx>
			$<$<CONFIG:MINSIZEREL>:		${MINSIZEREL_COMPILE_OPTIONS} 		-mavx>
		)
	endif()


	SET_TARGET_PROPERTIES(${FE_FRAMEWORK} PROPERTIES
        ARCHIVE_OUTPUT_DIRECTORY_DEBUG 			${CMAKE_CURRENT_SOURCE_DIR}/Linux/debug/a
        ARCHIVE_OUTPUT_DIRECTORY_RELWITHDEBINFO ${CMAKE_CURRENT_SOURCE_DIR}/Linux/release_with_debug_info/a
        ARCHIVE_OUTPUT_DIRECTORY_RELEASE 		${CMAKE_CURRENT_SOURCE_DIR}/Linux/release/a
        ARCHIVE_OUTPUT_DIRECTORY_MINSIZEREL 	${CMAKE_CURRENT_SOURCE_DIR}/Linux/minimally_sized_release/a
    )


	TARGET_LINK_LIBRARIES(${FE_FRAMEWORK}
#		stdc++fs
#		${TBB_LINUX}
#		${TBB_MALLOC_LINUX}
#		${BOOST_STACKTRACE_LINUX}
	)




elseif(CMAKE_SYSTEM_NAME STREQUAL "Windows")
	MESSAGE("Configurating The Build Environment for Windows X86-64 Distributions")

	TARGET_COMPILE_OPTIONS(${FE_FRAMEWORK} PRIVATE
        $<$<CONFIG:DEBUG>:			${DEBUG_COMPILE_OPTIONS} 			/arch:AVX>
        $<$<CONFIG:RELWITHDEBINFO>:	${RELWITHDEBINFO_COMPILE_OPTIONS} 	/arch:AVX>
        $<$<CONFIG:RELEASE>:		${RELEASE_COMPILE_OPTIONS} 			/arch:AVX>
        $<$<CONFIG:MINSIZEREL>:		${MINSIZEREL_COMPILE_OPTIONS} 		/arch:AVX>
    )


	SET_TARGET_PROPERTIES(${FE_FRAMEWORK} PROPERTIES
		ARCHIVE_OUTPUT_DIRECTORY_DEBUG 			${CMAKE_CURRENT_SOURCE_DIR}/Windows/debug/lib
        ARCHIVE_OUTPUT_DIRECTORY_RELWITHDEBINFO ${CMAKE_CURRENT_SOURCE_DIR}/Windows/release_with_debug_info/lib
        ARCHIVE_OUTPUT_DIRECTORY_RELEASE 		${CMAKE_CURRENT_SOURCE_DIR}/Windows/release/lib
        ARCHIVE_OUTPUT_DIRECTORY_MINSIZEREL 	${CMAKE_CURRENT_SOURCE_DIR}/Windows/minimally_sized_release/lib
    )


	TARGET_LINK_LIBRARIES(${FE_FRAMEWORK} 
#		${TBB_WINDOWS}
#		${TBB_MALLOC_WINDOWS}
#		${BOOST_STACKTRACE_WINDOWS}
	)




endif()
